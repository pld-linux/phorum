# require config from /etc/webapps
# chdir .. before including common.php

--- phorum-5.2.14/common.php~	2010-01-06 19:13:05.000000000 +0200
+++ phorum-5.2.14/common.php	2010-01-06 19:15:15.204911869 +0200
@@ -84,22 +84,22 @@
     ob_start();
 
     // Load configuration.
-    if (! include_once( "./include/db/config.php" )) {
+    if (! include_once( "/etc/webapps/phorum/config.php" )) {
         print '<html><head><title>Phorum error</title></head><body>';
         print '<h2>Phorum database configuration error</h2>';
 
         // No database configuration found.
-        if (!file_exists("./include/db/config.php")) { ?>
+        if (!file_exists("/etc/webapps/phorum/config.php")) { ?>
             Phorum has been installed on this server, but the configuration<br/>
             for the database connection has not yet been made. Please read<br/>
             <a href="docs/install.txt">docs/install.txt</a> for installation
             instructions. <?php
         } else {
-            $fp = fopen("./include/db/config.php", "r");
+            $fp = fopen("/etc/webapps/phorum/config.php", "r");
             // Unable to read the configuration file.
             if (!$fp) { ?>
                 A database configuration file was found in
-                ./include/db/config.php,<br/>but Phorum was unable to read it.
+                config.php,<br/>but Phorum was unable to read it.
                 Please check the file permissions<br/>for this file. <?php
             // Unknown error.
             } else {
--- phorum-5.2.14/include/admin/install.php~	2010-01-06 19:23:20.000000000 +0200
+++ phorum-5.2.14/include/admin/install.php	2010-01-06 19:23:35.421527751 +0200
@@ -25,7 +25,7 @@
 include_once("./include/api/user.php");
 
 if(!phorum_db_check_connection()){
-    echo "A database connection could not be established.  Please edit include/db/config.php.";
+    echo "A database connection could not be established.  Please edit config.php.";
     return;
 }
 
--- phorum-5.0.21/admin.php	2005-03-17 19:41:22.000000000 +0200
+++ phorum-5.0.21.pld/admin.php	2006-03-08 18:23:04.000000000 +0200
@@ -26,6 +26,7 @@
     // the code run faster.
     error_reporting  (E_ERROR | E_WARNING | E_PARSE);
 
+    chdir("..");
     include_once "./common.php";
     include_once "./include/users.php";
 
--- phorum-5.0.21/control.php	2005-10-29 00:02:51.000000000 +0300
+++ phorum-5.0.21.pld/control.php	2006-03-08 18:23:04.000000000 +0200
@@ -18,6 +18,7 @@
 ////////////////////////////////////////////////////////////////////////////////
 define('phorum_page','control');
 
+chdir("..");
 include_once("./common.php");
 
 phorum_require_login();
--- phorum-5.0.21/file.php	2005-03-17 19:41:22.000000000 +0200
+++ phorum-5.0.21.pld/file.php	2006-03-08 18:23:04.000000000 +0200
@@ -23,6 +23,7 @@
 ini_set ( "zlib.output_compression", "0");
 ini_set ( "output_handler", "");
 
+chdir("..");
 include_once("./common.php");
 
 // checking read-permissions
--- phorum-5.0.21/follow.php	2005-03-17 19:41:22.000000000 +0200
+++ phorum-5.0.21.pld/follow.php	2006-03-08 18:23:04.000000000 +0200
@@ -18,6 +18,7 @@
 ////////////////////////////////////////////////////////////////////////////////
 define('phorum_page','subscribe');
 
+chdir("..");
 include_once("./common.php");
 
 phorum_require_login();
--- phorum-5.0.21/index.php	2005-03-17 19:41:22.000000000 +0200
+++ phorum-5.0.21.pld/index.php	2006-03-08 18:23:04.000000000 +0200
@@ -17,6 +17,7 @@
 ///////////////////////////////////////////////////////////////////////////////
 define('phorum_page','index');
 
+chdir("..");
 include_once( "./common.php" );
 
 include_once( "./include/format_functions.php" );
--- phorum-5.0.21/list.php	2005-04-01 20:10:41.000000000 +0300
+++ phorum-5.0.21.pld/list.php	2006-03-08 18:23:04.000000000 +0200
@@ -18,6 +18,7 @@
 ////////////////////////////////////////////////////////////////////////////////
 define('phorum_page','list');
 
+chdir("..");
 include_once("./common.php");
 include_once("./include/format_functions.php");
 
--- phorum-5.0.21/login.php	2005-10-15 13:51:01.000000000 +0300
+++ phorum-5.0.21.pld/login.php	2006-03-08 18:23:04.000000000 +0200
@@ -18,6 +18,7 @@
 ////////////////////////////////////////////////////////////////////////////////
 define('phorum_page','login');
 
+chdir("..");
 include_once( "./common.php" );
 include_once( "./include/users.php" );
 include_once( "./include/email_functions.php" );
--- phorum-5.2.14/moderation.php~	2010-01-06 19:21:12.000000000 +0200
+++ phorum-5.2.14/moderation.php	2010-01-06 19:22:37.991532354 +0200
@@ -19,6 +19,7 @@
 ////////////////////////////////////////////////////////////////////////////////
 
 define('phorum_page','moderation');
+chdir("..");
 include_once("./common.php");
 include_once("./include/moderation_functions.php");
 include_once("./include/thread_info.php");
--- phorum-5.1.25/posting.php~	2007-06-29 18:03:25.000000000 +0300
+++ phorum-5.1.25/posting.php	2007-12-27 18:49:04.318221622 +0200
@@ -55,6 +55,7 @@
     define('phorum_page', 'post');
 }
 
+chdir("..");
 include_once("./common.php");
 include_once("include/format_functions.php");
 
--- phorum-5.0.21/profile.php	2005-04-15 16:37:05.000000000 +0300
+++ phorum-5.0.21.pld/profile.php	2006-03-08 18:23:05.000000000 +0200
@@ -18,6 +18,7 @@
 ////////////////////////////////////////////////////////////////////////////////
 define('phorum_page','profile');
 
+chdir("..");
 include_once("./common.php");
 include_once("./include/email_functions.php");
 include_once("./include/format_functions.php");
--- phorum-5.0.21/read.php	2005-04-01 20:10:41.000000000 +0300
+++ phorum-5.0.21.pld/read.php	2006-03-08 18:23:05.000000000 +0200
@@ -18,6 +18,7 @@
 ////////////////////////////////////////////////////////////////////////////////
 define('phorum_page','read');
 
+chdir("..");
 include_once("./common.php");
 include_once("./include/email_functions.php");
 include_once("./include/format_functions.php");
--- phorum-5.0.21/register.php	2005-10-14 23:46:40.000000000 +0300
+++ phorum-5.0.21.pld/register.php	2006-03-08 18:23:05.000000000 +0200
@@ -18,6 +18,7 @@
 ////////////////////////////////////////////////////////////////////////////////
 define('phorum_page','register');
 
+chdir("..");
 include_once("./common.php");
 include_once("./include/users.php");
 include_once("./include/profile_functions.php");
--- phorum-5.2.14/script.php~	2010-01-06 19:24:04.000000000 +0200
+++ phorum-5.2.14/script.php	2010-01-06 19:24:20.091522133 +0200
@@ -22,7 +22,7 @@
 define('phorum_page','script');
 define('PHORUM_SCRIPT', 1);
 
-chdir(dirname(__FILE__));
+chdir("..");
 include_once("./common.php");
 
 // if we are running in the webserver, bail out
--- phorum-5.0.21/search.php	2005-11-03 23:56:46.000000000 +0200
+++ phorum-5.0.21.pld/search.php	2006-03-08 18:23:05.000000000 +0200
@@ -18,6 +18,7 @@
 ////////////////////////////////////////////////////////////////////////////////
 define('phorum_page','search');
 
+chdir("..");
 include_once("./common.php");
 
 if(!phorum_check_read_common()) {
